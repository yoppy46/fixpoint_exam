# 株式会社フィックスポイントプログラミング試験

以下に問1～問4の設問内容,実行方法,実行結果をまとめる.
使用言語:python

(問1)
監視ログファイルを読み込み, 故障状態のサーバアドレスとそのサーバの故障期間を出力するプログラムを作成せよ.
出力フォーマットは任意でよい.
なお、pingがタイムアウトした場合を故障とみなし, 最初にタイムアウトしたときから, 次にpingの応答が返るまでを故障期間とする.

ファイル名:question1.py

#解説
作成した監視ログファイル(monitoringlog.txt)を読み込み, 確認日時,サーバアドレス,応答結果をそれぞれ
date,server,pingtime配列に格納する.次にそれぞれサーバー(今回は5種類)毎の確認日時,応答結果をdates,pingtimes配列にまとめる.

pingtimes配列を使用して,サーバー毎の故障判定を行う.
<判定方法>
サーバー毎にj番目のpingがタイムアウトかつ,j-1番目がタイムアウトではない日時をfor文で探し,そこからwhile文をj+s番目(s+=1)がタイムアウトでは
なくなるまで動かす.j~j+sの期間が故障機関となる.
もし,確認日時が監視ログの最後でタイムアウトとなった場合,故障期間を判定できないので故障開始日時だけ出力している.

<実行結果>
サーバーアドレス:10.20.30.1/16
故障期間:20201019133324--20201019133624

サーバーアドレス:10.20.30.2/16
故障期間:20201019133325--20201019133525

サーバーアドレス:192.168.1.1/24
故障期間:20201019133134--20201019133234

サーバーアドレス:192.168.1.1/24
故障期間:20201019133534--

サーバーアドレス:192.168.1.2/24
故障期間:20201019133135--20201019133335

サーバーアドレス:192.168.1.2/24
故障期間:20201019133535--

サーバーアドレス:192.168.1.3/24
故障期間:20201019133536--



(問2)
ネットワークの状態によっては,一時的にpingがタイムアウトしても,一定期間するとpingの応答が復活することがあり,
そのような場合はサーバの故障とみなさないようにしたい.
N回以上連続してタイムアウトした場合にのみ故障とみなすように,設問1のプログラムを拡張せよ.
Nはプログラムのパラメータとして与えられるようにすること.

ファイル名:question2.py

#解説
問1の故障判定を少し変更する.
具体的には,while文でのsが故障期間の長さになるので,sがN以上となれば故障と判定するように変更した.

<実行結果>
N=2の場合

サーバーアドレス:10.20.30.1/16
故障期間:20201019133324--20201019133624

サーバーアドレス:10.20.30.2/16
故障期間:20201019133325--20201019133525

サーバーアドレス:192.168.1.1/24
故障期間:20201019133534--  :故障の可能性有り

サーバーアドレス:192.168.1.2/24
故障期間:20201019133135--20201019133335

サーバーアドレス:192.168.1.2/24
故障期間:20201019133535--  :故障の可能性有り

サーバーアドレス:192.168.1.3/24
故障期間:20201019133536--  :故障の可能性有り


N=3の場合

サーバーアドレス:10.20.30.1/16
故障期間:20201019133324--20201019133624

サーバーアドレス:192.168.1.1/24
故障期間:20201019133534--  :故障の可能性有り

サーバーアドレス:192.168.1.2/24
故障期間:20201019133535--  :故障の可能性有り

サーバーアドレス:192.168.1.3/24
故障期間:20201019133536--  :故障の可能性有り



(問3)
サーバが返すpingの応答時間が長くなる場合,サーバが過負荷状態になっていると考えられる.
そこで、直近m回の平均応答時間がtミリ秒を超えた場合は,サーバが過負荷状態になっているとみなそう.
設問2のプログラムを拡張して,各サーバの過負荷状態となっている期間を出力できるようにせよ.mとtはプログラムのパラメータとして与えられるようにすること.

ファイル名:question3.py

#解説
まずタイムアウトがあると平均応答時間が求めれないので,サーバー毎のタイムアウト('-')を削除したorganize_pingtimes配列,同様にorganize_dates配列も
作成した.そしてorganize_pingtimesの要素数がm以下だった場合は,全ての要素から平均応答時間を求め,tを超えていた場合過負荷と判定する.
要素数がmより多かった場合は,j番目からj+m番目までの平均応答時間を全て求め,tを超えた期間を過負荷と判定する.

<実行結果>

m=3,t=3の場合

過負荷サーバ:10.20.30.1/16
過負荷期間:20201019133124-20201019133624

過負荷サーバ:192.168.1.1/24
過負荷期間:20201019133234-20201019133434

過負荷サーバ:192.168.1.2/24
過負荷期間:20201019133335-20201019133435


m=4,t=100の場合

過負荷サーバ:10.20.30.1/16
過負荷期間:20201019133124-20201019133624


(問4)
ネットワーク経路にあるスイッチに障害が発生した場合、そのスイッチの配下にあるサーバの応答がすべてタイムアウトすると想定される。
そこで、あるサブネット内のサーバが全て故障（ping応答がすべてN回以上連続でタイムアウト）している場合は、
そのサブネット（のスイッチ）の故障とみなそう。
設問2または3のプログラムを拡張して、各サブネット毎にネットワークの故障期間を出力できるようにせよ。

ファイル名:question4.py

#解説
まずpingがタイムアウトであった場合0,その他は1を格納したtimeout配列を作成する.
そしてサブネット内で同じ日時にすべてのサーバーがタイムアウト(timeout配列を用いて合計が0になればよい)になっている日時を探す.
そして問2と同様にwhile文を用いて故障期間がNを超えた場合,故障と判定する.

<実行結果>

N=2の場合

サブネット1
故障期間:20201019133324--20201019133524

サブネット2
故障期間:20201019133525--  :故障の可能性有り


N=3の場合

サブネット2
故障期間:20201019133525--  :故障の可能性有り
